<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STOCK-VISION</title>
  <link rel="stylesheet" href="../styles/usuarios.css">
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <header>
    <a href="admin.html" class="back-btn">⬅ Volver al Panel</a>
    <h1>Gestión de Usuarios</h1>
  </header>

  <section id="tablaUsuarios">
    <table>
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Email</th>
          <th>Rol</th>
          <th>Contraseña</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="usuariosBody"></tbody>
    </table>
  </section>

  <!-- Modal para editar -->
  <div id="modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Nuevo Usuario</h2>
            <button class="close" id="closeModal">&times;</button>
        </div>
        <form id="formUsuario">
            <input type="hidden" id="usuarioId">
            
            <div class="form-group">
                <label for="nombre">Nombre:</label>
                <input type="text" id="nombre" name="nombre" required placeholder="Ingrese el nombre">
            </div>
            
            <div class="form-group">
                <label for="apellido">Apellido:</label>
                <input type="text" id="apellido" name="apellido" required placeholder="Ingrese el apellido">
            </div>
            
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required placeholder="Ingrese el email">
            </div>
            
            <div class="form-group">
                <label for="password">Contraseña:</label>
                <input type="password" id="password" name="password" required placeholder="Ingrese la contraseña">
            </div>
            
            <div class="form-group">
                <label for="role">Rol:</label>
                <select id="role" name="role" required>
                    <option value="">Seleccione un rol</option>
                    <option value="cliente">Cliente</option>
                    <option value="admin">Administrador</option>
                </select>
            </div>
            
            <div class="form-actions">
                <button type="button" class="cancel-btn" id="cancelarForm">Cancelar</button>
                <button type="submit" id="btnGuardar">Guardar</button>
            </div>
        </form>
    </div>
  </div>

  <!-- Modal de confirmación para eliminar usuario -->
  <div id="modalConfirmacion" class="modal confirmation-modal">
      <div class="modal-content">
          <div class="modal-header">
              <h2>Confirmar Eliminación</h2>
              <span class="close confirm-close">&times;</span>
          </div>
          <div class="confirmation-body">
              <p>¿Seguro que deseas eliminar este usuario?</p>
              <div class="confirmation-actions">
                  <button class="cancel-btn" id="cancelarEliminar">Cancelar</button>
                  <button class="delete-btn" id="confirmarEliminar">Eliminar</button>
              </div>
          </div>
      </div>
  </div>

  <!-- Modal de Notificación -->
  <div id="modalNotificacion" class="modal notificacion-modal">
      <div class="modal-content">
          <div class="notificacion-header" id="notificacionHeader">
              <div class="notificacion-icon" id="notificacionIcon"></div>
              <h3 id="notificacionTitulo">Éxito</h3>
              <button class="close notificacion-close">&times;</button>
          </div>
          <div class="notificacion-body">
              <p id="notificacionMensaje">Usuario actualizado correctamente</p>
              <button class="btn notificacion-btn" id="aceptarNotificacion">Aceptar</button>
          </div>
      </div>
  </div>

  <script src="../js/seguridad.js"></script>
  <script>
      document.addEventListener('DOMContentLoaded', function() {
          protectPage('admin');
      });
  </script>
  <script src="../js/usuarios.js"></script>
  
</body>
</html>
